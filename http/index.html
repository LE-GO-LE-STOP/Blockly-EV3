<html>
	<head>
		<title>Blockly - EV3</title>
	</head>

	<body>
		<div style="position: absolute; top: 0; left: 0; width: 100%; height: 80px">
			<h1>
				Blockly - EV3
			</h1>
		</div>

		<div id="blocklyArea" style="position: absolute; top: 80; bottom: 0; left: 0; right: 0;">
			<div id="blocklyDiv" style="position: absolute; width: 100%; height: 100%; top: 0; right: 0;"></div>
		</div>

		<script src="blockly/blockly_compressed.js"></script>
		<script src="blockly/blocks_compressed.js"></script>
		<script src="blockly/python_compressed.js"></script>
		<script src="blockly/msg/js/en.js"></script>

		<script src="blocks/io.js"></script>
		<script src="blocks/buttons.js"></script>
		<script src="blocks/sound.js"></script>
		<script src="blocks/colour.js"></script>

		<xml id="toolbox" style="display: none">
			<category id="catIO" colour="0" name="Input/Output">
				<block type="ev3io_motoron">
					<value name="POWER">
						<shadow type="math_number">
							<field name="NUM">100</field>
						</shadow>
					</value>
				</block>
				<block type="ev3io_motoroff"></block>
				<block type="ev3io_motoronforseconds">
					<value name="TIME">
						<shadow type="math_number">
							<field name="NUM">0</field>
						</shadow>
					</value>
					<value name="POWER">
						<shadow type="math_number">
							<field name="NUM">100</field>
						</shadow>
					</value>
				</block>
				<block type="ev3io_motoronfordegrees">
					<value name="DEGREES">
						<shadow type="math_number">
							<field name="NUM">0</field>
						</shadow>
					</value>
					<value name="POWER">
						<shadow type="math_number">
							<field name="NUM">100</field>
						</shadow>
					</value>
				</block>
				<block type="ev3io_motoronforrotations">
					<value name="ROTATIONS">
						<shadow type="math_number">
							<field name="NUM">0</field>
						</shadow>
					</value>
					<value name="POWER">
						<shadow type="math_number">
							<field name="NUM">100</field>
						</shadow>
					</value>
				</block>
				<block type="ev3io_sensorset"></block>
				<category id="catTouchSensor" colour="65" name="Touch Sensor">
					<block type="ev3io_sensortouch"></block>
					<block type="ev3io_sensortouch_pressed"></block>
				</category>
				<category id="catColourSensor" colour="65" name="Colour Sensor">
					<block type="ev3io_sensorcolour"></block>
					<block type="ev3io_sensorcolour_reflected"></block>
					<block type="ev3io_sensorcolour_ambient"></block>
					<block type="ev3io_sensorcolour_colour"></block>
				</category>
				<category id="catUltrasonicSensor" colour="65" name="Ultrasonic Sensor">
					<block type="ev3io_sensorultrasonic"></block>
					<block type="ev3io_sensorultrasonic_distance"></block>
					<block type="ev3io_sensorultrasonic_nearby"></block>
				</category>
				<category id="catInfraredSensor" colour="65" name="Infrared Sensor">
					<block type="ev3io_sensorinfrared"></block>
					<block type="ev3io_sensorinfrared_proximity"></block>
					<block type="ev3io_sensorinfrared_seekheading"></block>
					<block type="ev3io_sensorinfrared_seekproximity"></block>
					<block type="ev3io_sensorinfrared_remote"></block>
				</category>
			</category>
			<category id="catButtons" colour="0" name="Brick Buttons">
				<block type="ev3brick_button"></block>
				<block type="ev3brick_ledbrightness">
					<value name="BRIGHTNESS">
						<shadow type="math_number">
							<field name="NUM">100</field>
						</shadow>
					</value>
				</block>
				<block type="ev3brick_ledcolour"></block>
			</category>
			<category id="catSound" colour="0" name="Sound">
				<block type="ev3sound_tone">
					<value name="HZ">
						<shadow type="math_number">
							<field name="NUM">500</field>
						</shadow>
					</value>
					<value name="TIME">
						<shadow type="math_number">
							<field name="NUM">0.5</field>
						</shadow>
					</value>
				</block>
				<block type="ev3sound_speak">
					<value name="TEXT">
						<shadow type="text"></shadow>
					</value>
				</block>
			</category>
			<sep></sep>
			<category id="catLogic" colour="210" name="Logic">
				<block type="controls_if"></block>
				<block type="logic_compare"></block>
				<block type="logic_operation"></block>
				<block type="logic_negate"></block>
				<block type="logic_boolean"></block>
				<block type="logic_null"></block>
				<block type="logic_ternary"></block>
			</category>
			<category id="catLoops" colour="120" name="Loops">
				<block type="controls_repeat_ext">
					<value name="TIMES">
						<shadow type="math_number">
							<field name="NUM">10</field>
						</shadow>
					</value>
				</block>
				<block type="controls_whileUntil"></block>
				<block type="controls_for">
					<value name="FROM">
						<shadow type="math_number">
							<field name="NUM">1</field>
						</shadow>
					</value>
					<value name="TO">
						<shadow type="math_number">
							<field name="NUM">10</field>
						</shadow>
					</value>
					<value name="BY">
						<shadow type="math_number">
							<field name="NUM">1</field>
						</shadow>
					</value>
				</block>
				<block type="controls_forEach"></block>
				<block type="controls_flow_statements"></block>
			</category>
			<category id="catMath" colour="230" name="Math">
				<block type="math_number"></block>
				<block type="math_arithmetic">
					<value name="A">
						<shadow type="math_number">
							<field name="NUM">1</field>
						</shadow>
					</value>
					<value name="B">
						<shadow type="math_number">
							<field name="NUM">1</field>
						</shadow>
					</value>
				</block>
				<block type="math_single">
					<value name="NUM">
						<shadow type="math_number">
							<field name="NUM">9</field>
						</shadow>
					</value>
				</block>
				<block type="math_trig">
					<value name="NUM">
						<shadow type="math_number">
							<field name="NUM">45</field>
						</shadow>
					</value>
				</block>
				<block type="math_constant"></block>
				<block type="math_number_property">
					<value name="NUMBER_TO_CHECK">
						<shadow type="math_number">
							<field name="NUM">0</field>
						</shadow>
					</value>
				</block>
				<block type="math_change">
					<value name="DELTA">
						<shadow type="math_number">
							<field name="NUM">1</field>
						</shadow>
					</value>
				</block>
				<block type="math_round">
					<value name="NUM">
						<shadow type="math_number">
							<field name="NUM">3.1</field>
						</shadow>
					</value>
				</block>
				<block type="math_on_list"></block>
				<block type="math_modulo">
					<value name="DIVIDEND">
						<shadow type="math_number">
							<field name="NUM">64</field>
						</shadow>
					</value>
					<value name="DIVISOR">
						<shadow type="math_number">
							<field name="NUM">10</field>
						</shadow>
					</value>
				</block>
				<block type="math_constrain">
					<value name="VALUE">
						<shadow type="math_number">
							<field name="NUM">50</field>
						</shadow>
					</value>
					<value name="LOW">
						<shadow type="math_number">
							<field name="NUM">1</field>
						</shadow>
					</value>
					<value name="HIGH">
						<shadow type="math_number">
							<field name="NUM">100</field>
						</shadow>
					</value>
				</block>
				<block type="math_random_int">
					<value name="FROM">
						<shadow type="math_number">
							<field name="NUM">1</field>
						</shadow>
					</value>
					<value name="TO">
						<shadow type="math_number">
							<field name="NUM">100</field>
						</shadow>
					</value>
				</block>
				<block type="math_random_float"></block>
			</category>
			<category id="catText" colour="160" name="Text">
				<block type="text"></block>
				<block type="text_join"></block>
				<block type="text_append">
					<value name="TEXT">
						<shadow type="text"></shadow>
					</value>
				</block>
				<block type="text_length">
					<value name="VALUE">
						<shadow type="text">
							<field name="TEXT">abc</field>
						</shadow>
					</value>
				</block>
				<block type="text_isEmpty">
					<value name="VALUE">
						<shadow type="text">
							<field name="TEXT"></field>
						</shadow>
					</value>
				</block>
				<block type="text_indexOf">
					<value name="VALUE">
						<block type="variables_get">
							<field name="VAR">text</field>
						</block>
					</value>
					<value name="FIND">
						<shadow type="text">
							<field name="TEXT">abc</field>
						</shadow>
					</value>
				</block>
				<block type="text_charAt">
					<value name="VALUE">
						<block type="variables_get">
							<field name="VAR">text</field>
						</block>
					</value>
				</block>
				<block type="text_getSubstring">
					<value name="STRING">
						<block type="variables_get">
							<field name="VAR">text</field>
						</block>
					</value>
				</block>
				<block type="text_changeCase">
					<value name="TEXT">
						<shadow type="text">
							<field name="TEXT">abc</field>
						</shadow>
					</value>
				</block>
				<block type="text_trim">
					<value name="TEXT">
						<shadow type="text">
							<field name="TEXT">abc</field>
						</shadow>
					</value>
				</block>
				<block type="text_print">
					<value name="TEXT">
						<shadow type="text">
							<field name="TEXT">abc</field>
						</shadow>
					</value>
				</block>
			</category>
			<category id="catLists" colour="260" name="Lists">
				<block type="lists_create_with">
					<mutation items="0"></mutation>
				</block>
				<block type="lists_create_with"></block>
				<block type="lists_repeat">
					<value name="NUM">
						<shadow type="math_number">
							<field name="NUM">5</field>
						</shadow>
					</value>
				</block>
				<block type="lists_length"></block>
				<block type="lists_isEmpty"></block>
				<block type="lists_indexOf">
					<value name="VALUE">
						<block type="variables_get">
							<field name="VAR">list</field>
						</block>
					</value>
				</block>
				<block type="lists_getIndex">
					<value name="VALUE">
						<block type="variables_get">
							<field name="VAR">list</field>
						</block>
					</value>
				</block>
				<block type="lists_setIndex">
					<value name="LIST">
						<block type="variables_get">
							<field name="VAR">list</field>
						</block>
					</value>
				</block>
				<block type="lists_getSublist">
					<value name="LIST">
						<block type="variables_get">
							<field name="VAR">list</field>
						</block>
					</value>
				</block>
				<block type="lists_split">
					<value name="DELIM">
						<shadow type="text">
							<field name="TEXT">,</field>
						</shadow>
					</value>
				</block>
				<block type="lists_sort"></block>
			</category>
			<category id="catColour" colour="30" name="Colour">
				<block type="ev3colour_picker"></block>
			</category>
			<sep></sep>
			<category id="catVariables" colour="330" custom="VARIABLE" name="Variables"></category>
			<category id="catFunctions" colour="290" custom="PROCEDURE" name="Functions"></category>
		</xml>

		<script>
			Blockly.Python.addReservedWords("ev3_motors,ev3_sensors");

			var blocklyArea = document.getElementById("blocklyArea");
			var blocklyDiv = document.getElementById("blocklyDiv");
			var workspace = Blockly.inject("blocklyDiv", {
				media: "blockly/media/",
				toolbox: document.getElementById("toolbox")
			});

			function generate() {
				var code = "import ev3\n";
				code += "ev3_motors = {'outA': ev3.Motor('outA'), 'outB': ev3.Motor('outB'), 'outC': ev3.Motor('outC'), 'outD': ev3.Motor('outD')}\n";
				code += "ev3_sensors = {}\n";
				code += Blockly.Python.workspaceToCode(workspace);
				return code;
			}
		</script>
	</body>
</html>